<div class="bx" [class.darkMode]="userProfilesService.userProfile?.darkMode">
    <div class="container">
        <div class="profile-upper">
            <!-- start cover img section -->
            <div 
            class="mx-lg-5  coverImg d-flex justify-content-center align-items-center position-relative">
               <!-- start animation loading for cover img -->
            <div class="ovr" *ngIf='coverImgLoding'>
                    <div class="lds-ellipsis">
                        <div></div>
                        <div></div>
                        <div></div>
                        <div></div>
                    </div>
                </div>
                          <!-- start animation loading for cover img -->
                <img *ngIf="userProfilesService.userProfile?.coverImage" class="w-100 h-100" [src]="userProfilesService.userProfile?.coverImage" alt="">
                <div 
                class="addCVR">
                    <div  mat-button [matMenuTriggerFor]="cvrImg">
                         <i class="fas fa-camera mr-lg-1"></i>
                    <span 
                    class="d-none d-lg-inline-block"
                    style="cursor: pointer;">{{userProfilesService.userProfile?.coverImage ? 'Edit Cover Photo' : 'Add Cover Photo'}}</span>
                    </div>
                    <input accept="image/*" *ngIf="!userProfilesService.userProfile?.coverImage" (change)='selectCoverImg($event)' type="file">
                    <div>
                        <mat-menu #cvrImg="matMenu">
                       <div
                       
                       [class.darkModeMenu]="userProfilesService.userProfile?.darkMode"
                       >
                        <button mat-menu-item>                         
                            <i class="far fa-images mr-1"></i> Upload Photo
                        <input accept="image/*" (change)='selectCoverImg($event)' type="file">                    
                    </button>
                    <button
                    (click)="openModal(deleteCVRImg)"
                    mat-menu-item>
                        <i class="far fa-trash-alt mr-1"></i> Remove
                    </button>
                       </div>
                    
                         </mat-menu>
                    </div>
                   
                </div>
            </div>
            <!-- end cover img section -->
            <!-- start profile img section -->
            <div class="profileImg paddinggx">
                <div class="flex-column flex-lg-row align-items-center d-flex">
               <!-- start animation loading for profile img -->
                    <div class="imgg position-relative">
                        <div class="ovr" *ngIf="profileImgLoding">
                            <div class="lds-ellipsis">
                                <div></div>
                                <div></div>
                                <div></div>
                                <div></div>
                            </div>
                        </div>
                         <!-- end animation loading for profile img -->
                        <img 
                        #profileImG
                        (click)="profilePhotoss(profileImG)"
                        style="cursor: pointer;"
                        [src]="userProfilesService.userProfile?.profilePhoto | gender :  userProfilesService.userProfile?.gender" alt="" 
                                     >
                        <div 
                        class="addprofileImg">
                           <div  mat-button [matMenuTriggerFor]="profileImg">
                            <i class="fas fa-camera"></i>
                            
                           </div>
                           <input accept="image/*" *ngIf="!userProfilesService.userProfile?.profilePhoto" (change)='selectProfileImg($event)' type="file">
                        </div>
                        <!-- start profile img menu -->
                        <mat-menu #profileImg="matMenu">
                            <div
                            [class.darkModeMenu]="userProfilesService.userProfile?.darkMode"
                            >

                                <button mat-menu-item>
                                    <i class="far fa-images mr-1"></i> Update Profile Picture
                                    <input accept="image/*" (change)='selectProfileImg($event)' type="file">
                                </button>
                                <button 
                                routerLink="/myProfile/profilePhotos"
                                mat-menu-item
                                 *ngIf="userProfilesService.userProfile?.profilePhoto">
                                    <i class="bi bi-person-square mr-1"></i> View Profile Photo
                                </button>
                                <button 
                                (click)="openModal(deleteProfileRImg)"
                                mat-menu-item>
                                    <i class="far fa-trash-alt mr-1"></i> Remove
                                </button>
                            </div>
                        
                          </mat-menu>
                           <!-- start profile img menu -->
                    </div>
                   
                 <div class="w-100 text-center text-md-left flex-column flex-md-row d-flex justify-content-between align-items-center ml-md-5 position-relative">
                   <div>
                    <h1 
                    class="  mt-3 mb-1 font-weight-bold">
                    {{userProfilesService.userProfile?.firstName | titlecase | slice : 0 : 12}}
                        {{userProfilesService.userProfile?.lastName | titlecase | slice : 0 : 12}}</h1>
                        <h3 
                        mat-button [matMenuTriggerFor]="bio"
                        *ngIf="userProfilesService.userProfile?.bio;else addBioo"
                        class="d-md-none">
                        {{userProfilesService.userProfile?.bio | titlecase}}
                    </h3>
                    <p 
                    routerLink="/myProfile/layout/friends"
                    *ngIf="userProfilesService?.followers?.length"
                    class="d-none d-md-block font-weight-bold mb-1 followersLength">
                    {{userProfilesService?.followers?.length}} 
                    {{userProfilesService?.followers?.length==1 ? "Follower" : "Followers"}}
                </p>
                    <ul 
                    *ngIf="userProfilesService?.followers?.length"
                    (mouseleave)="profileOnHoverforFollowers=-1"
                    class="mb-5 d-none d-md-flex position-relative followersIMGS list-unstyled">
                         <li *ngFor="let follow of userProfilesService?.followers | slice : 0 : 6;let i = index">
                             <img [src]="follow?.profilePhoto | gender : follow?.gender" 
                             (mouseover)="profileOnHoverforFollowers=i"
                             [routerLink]="['/visit',follow?._id]"
                             alt="">
                             <div *ngIf="profileOnHoverforFollowers==i" class=" profileOnHover bg-white rounded-lg p-3">
                                <div class="d-flex align-items-center">
                                   <div>
                                    <div class="overIMG"  [routerLink]="['/visit',follow?._id]">
                                        <img 
                                       
                                        class="profile" [src]="follow?.profilePhoto | gender : follow?.gender" alt="">
                                    </div>
                                   </div>
                                    <div class="mx-3">
                                        <h2 
                                        [routerLink]="['/visit',follow?._id]"
                                        class="mb-2 ">{{follow?.firstName | titlecase | slice : 0 : 12}}
                                            {{follow?.lastName | titlecase | slice : 0 : 12}}</h2>
                                        <p><i class="far fa-calendar-alt mr-2"></i> Born on
                                            {{follow?.birthDate |date}}</p>
                                    </div>
                                </div>
                            </div>
                         </li>
                    </ul>
                   </div>
                   <div>
                    <button 
                     routerLink='/myProfile/layout/about'
                        class="d-none d-md-block mt-3 btn btn-primary" 
                        style="font-weight: 500;">
                        <i class="fas fa-pen mr-2"></i>   Edit Profile
                    </button>
                </div>
                 </div>
                    <ng-template #addBioo>
                        <h3 class="d-md-none text-primary"  (click)="textAreaLength=0;bioForm.reset();openModal(editBio)">Add Bio</h3>
                    </ng-template>
                    
                    <mat-menu #bio="matMenu">
                        <div  [class.darkModeMenu]="userProfilesService.userProfile?.darkMode">
                            <button 
                            (click)="openModal(editBio)"
                            mat-menu-item>
                                <i class="fas fa-pen mr-2"></i> Edit Bio
                            </button>
                            <button 
                            (click)="deleteBio()"
                            mat-menu-item>
                                <i class="far fa-trash-alt mr-2"></i> Remove
                            </button>
                        </div>
                    
                      </mat-menu>
                </div>
                <hr class="mb-0">
                <!-- start main nav  -->
                    <ul  class="list-unstyled d-flex mb-0 pageItems">
                        <li routerLinkActive="active" routerLink="../layout/posts" ><span>Posts</span></li>
                        <li routerLinkActive="active" routerLink="../layout/about"><span>About</span></li>
                        <li routerLinkActive="active" routerLink="../layout/friends"><span>Friends</span></li>
                        <li routerLinkActive="active" routerLink="../layout/photos"><span>Photos</span></li>
                    </ul>
              <!-- end main nav  -->
            </div>
            <!-- end profile img section -->
    
        </div>
    </div>
</div>
<div 
[class.darkMode]="userProfilesService.userProfile?.darkMode"
class=" profile-down pt-4" style="padding-bottom: 150px;">
<router-outlet></router-outlet>
</div>
<ng-template #deleteCVRImg>
  
    <div  [class.popupDarkMode]="userProfilesService.userProfile?.darkMode">
        <div class="modal-header">
            <h2 class="modal-title pull-left">Remove Cover Photo</h2>
            <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
              <p class="mb-1">Are you sure that you want to remove your cover photo?</p>
              <div class="d-flex justify-content-end">
                  <button class="btn btn-secondary"
                   (click)="modalRef.hide()">Cancel</button>
                  <button  #btn class="btn btn-primary mx-2" 
                  (click)="deleteCoverImg()">Confirm</button>
              </div>
              <div *ngIf="modalLoadin" style="height:50px" class="text-center mb-3">
                  <div class="lds-facebook">
                        <div></div>
                        <div></div>
                        <div></div>
                  </div>
            </div>
          </div>
    </div>
  </ng-template>
  <ng-template #deleteProfileRImg>
   <div
   [class.popupDarkMode]="userProfilesService.userProfile?.darkMode"
   >
    <div class="modal-header">
        <h2 class="modal-title pull-left">Remove Profile Photo</h2>
        <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="modal-body">
          <p class="mb-1">Are you sure that you want to remove your Profile photo?</p>
          <div class="d-flex justify-content-end">
              <button class="btn btn-secondary"
               (click)="modalRef.hide()">Cancel</button>
              <button  #btn class="btn btn-primary mx-2" 
              (click)="deleteProfileImg()">Confirm</button>
          </div>
          <div *ngIf="modalLoadin" style="height:50px" class="text-center mb-3">
              <div class="lds-facebook">
                    <div></div>
                    <div></div>
                    <div></div>
              </div>
        </div>
      </div>
   </div>
    
  </ng-template>
  <ng-template #editBio>

    <div  [class.popupDarkMode]="userProfilesService.userProfile?.darkMode">
        <div class="modal-header">
            <h2 class="modal-title pull-left">Edit Bio</h2>
            <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
              <i class="fas fa-times"></i>
            </button>
          </div>
          <div class="modal-body">
              <div class="position-relative">
              
                  <form 
                  [formGroup]="bioForm"
                  (ngSubmit)="addBio(bioForm.value)"
                  >
                      <textarea 
                      formControlName='bio'
                      #bioo placeholder="Describe who you are" maxLength="101" (keyup)="remaining(bioo)" class="text-center p-2 bioo"></textarea>
                      <span *ngIf="showRemaining" class="d-block my-1 text-secondary text-right">{{101 - textAreaLength}}  characters remaining</span>
                      <div class="d-flex">
                          <button  (click)="modalRef.hide()" type="button" class=" btn-secondary btn">Cancel</button>
                          <button [disabled]="bioForm.invalid" type="submit" class="mx-2 btn btn-primary">Save</button>
                      </div>
                  </form>
              </div>
              <div *ngIf="bioLoading" style="height:50px" class="text-center mb-3">
                  <div class="lds-facebook">
                        <div></div>
                        <div></div>
                        <div></div>
                  </div>
            </div>
          </div>
    </div>
  </ng-template>