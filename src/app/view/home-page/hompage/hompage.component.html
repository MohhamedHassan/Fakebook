<div class="parentOfHomePage  py-5"
[class.darkMode]="userProfilesService.userProfile?.darkMode"
>
    <div class="parentOfHomePageContainer mx-auto">
          <!-- start add post section -->
           <app-add-post></app-add-post>
        <!-- end add post section -->
        <!-- start people you may know -->
        <app-you-may-know></app-you-may-know>
        <!-- end people you may know -->
        <!-- start posts animation while loading -->
        <ng-container *ngIf="userProfileService.HomePageSkeltonLoading;else content">
            <div 
                class="fb-item bg-white postsLoadingg rounded-lg p-4">
                <div class="first-section-wrapper d-flex align-items-center mb-3">
                    <div class="gravatar ">
                        <ngx-skeleton-loader appearance="circle" [theme]="{
                                'width': '80px',
                                'height': '80px'
                            }">
                        </ngx-skeleton-loader>
                    </div>
                    <div class="gravatar-title mx-3">
                        <div>
                            <ngx-skeleton-loader [theme]="{
                      width: '90%',
                      'border-radius': '0',
                      height: '15px',
                      'margin-bottom': '10px'
                    }"></ngx-skeleton-loader>
                        </div>
                        <div>
                            <ngx-skeleton-loader
                                [theme]="{ width: '70%', 'border-radius': '0', height: '15px' }">
                            </ngx-skeleton-loader>
                        </div>
                    </div>
                </div>
                <div class="second-section-wrapper">
                    <div class="wrapper">
                        <ngx-skeleton-loader [theme]="{
                    width: '80%',
                    'border-radius': '0',
                    height: '15px',
                    'margin-bottom': '10px'
                  }"></ngx-skeleton-loader>
                    </div>
                    <div class="wrapper">
                        <ngx-skeleton-loader [theme]="{
                    width: '90%',
                    'border-radius': '0',
                    height: '15px',
                    'margin-bottom': '10px'
                  }"></ngx-skeleton-loader>
                    </div>
                    <div class="wrapper">
                        <ngx-skeleton-loader [theme]="{
                    width: '60%',
                    'border-radius': '0',
                    height: '15px',
                    'margin-bottom': '10px'
                  }"></ngx-skeleton-loader>
                    </div>
                </div>
            </div>
            <div 
                class="fb-item bg-white  postsLoadingg rounded-lg p-4 my-3">
                <div class="first-section-wrapper d-flex align-items-center mb-3">
                    <div class="gravatar ">
                        <ngx-skeleton-loader appearance="circle" [theme]="{ width: '80px', height: '80px' }">
                        </ngx-skeleton-loader>
                    </div>
                    <div class="gravatar-title mx-3">
                        <div>
                            <ngx-skeleton-loader [theme]="{
                      width: '90%',
                      'border-radius': '0',
                      height: '15px',
                      'margin-bottom': '10px'
                    }"></ngx-skeleton-loader>
                        </div>
                        <div>
                            <ngx-skeleton-loader
                                [theme]="{ width: '70%', 'border-radius': '0', height: '15px' }">
                            </ngx-skeleton-loader>
                        </div>
                    </div>
                </div>
                <div class="second-section-wrapper">
                    <div class="wrapper">
                        <ngx-skeleton-loader [theme]="{
                    width: '80%',
                    'border-radius': '0',
                    height: '15px',
                    'margin-bottom': '10px'
                  }"></ngx-skeleton-loader>
                    </div>
                    <div class="wrapper">
                        <ngx-skeleton-loader [theme]="{
                    width: '90%',
                    'border-radius': '0',
                    height: '15px',
                    'margin-bottom': '10px'
                  }"></ngx-skeleton-loader>
                    </div>
                    <div class="wrapper">
                        <ngx-skeleton-loader [theme]="{
                    width: '60%',
                    'border-radius': '0',
                    height: '15px',
                    'margin-bottom': '10px'
                  }"></ngx-skeleton-loader>
                    </div>
                </div>
            </div>
        </ng-container>
        <!-- end posts animation while loading -->
        <!-- start posts conetent -->
        <ng-template #content>
            <ng-container *ngIf="userProfileService.myFollowingPosts?.length;else noPosts">
                <div *ngFor="let post of userProfileService.myFollowingPosts;let i = index;trackBy:track" class=" postss bg-white py-1 rounded-lg mb-3">
                    <div class="p-3 d-flex justify-content-between align-items-center">
                        <div (mouseleave)='profileOnHover=-1' class="d-flex  align-items-center ">
                            <div 
                            [routerLink]="['/visit',post?.author[0]?._id]"
                            (mouseover)="profileOnHover=i">
                                <img  class="smllProfileImg mr-3" 
                                [src]="post?.author[0]?.profilePhoto | gender :  post?.author[0]?.gender" alt="">
                            </div>

                            <div>
                                <div (mouseover)="profileOnHover=i" (mouseleave)='profileOnHover=-1'>
                                    <h2 
                                    [routerLink]="['/visit',post?.author[0]?._id]"
                                    class="userName">
                                    {{ post?.author[0]?.firstName | titlecase |
                                        slice : 0 : 12}}
                                        {{ post?.author[0]?.lastName | titlecase | slice : 0 : 12}}
                                    </h2>
                                    <!-- start profile data on hover -->
                                    <div *ngIf="profileOnHover==i" class=" profileOnHover bg-white rounded-lg p-3">
                                        <div class="d-flex align-items-center">
                                        <div>
                                            <div  class="overIMG"  [routerLink]="['/visit',post?.author[0]?._id]">
                                                <img class="profile" 
                                                [src]=" post?.author[0]?.profilePhoto | gender : post?.author[0]?.gender" alt="">
                                            </div>
                                        </div>
                                            <div class="mx-3">
                                                <h2
                                                [routerLink]="['/visit',post?.author[0]?._id]"
                                                class="mb-2">{{ post?.author[0]?.firstName |
                                                    titlecase | slice : 0 : 12}}
                                                    {{ post?.author[0]?.lastName | titlecase | slice
                                                    : 0 : 12}}</h2>
                                                <p><i class="far fa-calendar-alt mr-2"></i> Born on
                                                    {{ post?.author[0]?.birthDate |date}}</p>
                                              
                                            </div>
                                        </div>
                                    </div>
                                      <!-- end profile data on hover -->
                                </div>
                                <!-- start post time  -->
                                <div class="position-relative">
                                    <div class="timee d-inline-block">
                                        <small class="text-secondary ">{{post?.updatedAt | date :'medium'}}</small>
                                        <small class="timeOnHover">{{post?.updatedAt | date :'medium'}}</small>
                                    </div>
                                </div>
                                <!-- end post time -->
                            </div>
                        </div>
                    </div>
                    <p #elementt class="px-3  text-break">
                        {{post?.content | text : i : seeMoreIndex | lang : elementt }}
                        <span *ngIf="post?.content?.length>500" class="font-weight-bold text-secondary"
                            style="cursor: pointer;direction: inherit;"
                            (click)="seeMoreIndex = seeMoreIndex == i ? -1 : i">
                            {{seeMoreIndex == i ? 'See Less' : '... See more'}}</span>
                    </p>
                    <img 
                    (click)="postComments = [];userProfileService.popUP=true;getPostComments(post._id,i)"
                    style="cursor: pointer;"
                    *ngIf="post?.image" [src]="post?.image" alt="" class="w-100 mt-3">
                    <div class="postOptions px-3">
                        <div class="my-2 d-flex justify-content-between align-items-center">
                                <div (click)="filterReactions='';reacionsModaClassIndex=-1;openReactionModal(post._id,reaction,i)"
                                style="cursor: pointer;" class="position-relative   reactionsCount ">                                             
                                            <img class="first" 
                                            #first
                                            [src]="post.love | mostReaction : post.sad : post.wow : post.haha : post.angry : post.like : first" alt="">
                                            <img #secondIMG  class="last" [src]="post.love | secondReaction: post.sad : post.wow : post.haha : post.angry : post.like  : secondIMG" alt=""> 
                                            <span  
                                            *ngIf="post?.numOfReactions">
                                            {{post?.numOfReactions}}</span>   
                                                              
                            </div>   
                            <p (click)="getPostComments(post._id,i)" class=" numOfComments" *ngIf="post?.numOfComments">
                                {{post?.numOfComments}}
                                {{post?.numOfComments==1 ? "Comment" : "Comments"}}
                            </p>
                        </div>
                        <div class="position-relative">
                            <ul class="options list-unstyled d-flex justify-content-center mb-3">
                                <li (mouseover)="showParentOfReactionsOnHover(parentOfReactions)"
                                    (mouseleave)="hideParentOfReactionsOnHover(parentOfReactions)"
                                    class="showReactions">
                                    <div class="userReact">
                                        <div *ngIf="!post?.myReaction?.length;else reactionFound">
                                            <i class="far fa-thumbs-up"></i> <span class="mx-2">Like</span>
                                        </div>
                                        <ng-template #reactionFound>
                                            <ng-container *ngFor="let itemm of reactions">
                                                <div *ngIf="post?.myReaction[0]?.reaction==itemm.reaction"
                                                    class="d-flex justify-content-center">
                                                    <img [src]="'assets/'+itemm.reaction+'.png'">
                                                    <span [class]="itemm.reaction" class="mx-2">
                                                        {{itemm.reaction | titlecase}}</span>
                                                </div>
                                            </ng-container>
                                        </ng-template>
                                    </div>
                                    <div #parentOfReactions class="hideParentOfReactions parentOfReactions">
                                        <ul class="reactions bg-white p-1 d-flex list-unstyled ">
                                            <li *ngFor="let item of reactions"
                                                (click)="makeReaction(item?.reaction,i,parentOfReactions,post?._id)">
                                                <img [src]="item?.imgSrc" alt="">
                                            </li>
                                        </ul>
                                    </div>
                                </li>
                                <li (click)="getPostComments(post._id,i)">
                                    <i class="far fa-comment-alt "></i>
                                    <span class="mx-2">Comment</span>
                                </li>
                            </ul>
                        </div>
                        <ng-container *ngIf="postCommentsIndex == i">
                            <div 
                            *ngIf="!commentsLoading"
                            class="d-flex writeAcomment">
                                <img [src]="userProfilesService.userProfile?.profilePhoto | gender : userProfilesService.userProfile?.gender "
                                    alt="">
                                <div class="position-relative w-100" style="padding-right:25px">
                                    <textarea (keydown.enter)="makeAComment($event,addCommentInput,post?._id,i)"
                                        (input)="textAreaHeightAuto(addCommentInput)" rows=1 #addCommentInput
                                        type="text" class="ml-2" placeholder="Write a comment..."></textarea>
                                    <i style="right: 30px;"
                                        (click)="makeAComment($event,addCommentInput,post?._id,i)"
                                        class="fas fa-paper-plane text-primary d-md-none "></i>
                                </div>
                            </div>
                            <div class="parentOfComments mt-2">
                                <ul class="comments list-unstyled my-2">
                                    <ng-container *ngIf="commentsLoading;else commentsConetent">
                                        <li *ngFor="let item of swiperLoadingCount">
                                            <div [class.darkMode]="userProfilesService.userProfile?.darkMode"
                                                class="fb-item bg-white postsLoadingg rounded-lg">
                                                <div
                                                    class="first-section-wrapper d-flex align-items-center mb-3">
                                                    <div class="gravatar ">
                                                        <ngx-skeleton-loader appearance="circle" [theme]="{
                                                        'width': '32px',
                                                        'height': '32px',
                                                        'margin':'0'
                                                    }">
                                                        </ngx-skeleton-loader>
                                                    </div>
                                                    <div class="gravatar-title mx-3">
                                                        <div>
                                                            <ngx-skeleton-loader [theme]="{
                                              width: '200px',
                                              'border-radius': '0',
                                              height: '5px',
                                              'margin-bottom': '5px'
                                            }"></ngx-skeleton-loader>
                                                        </div>
                                                        <div>
                                                            <ngx-skeleton-loader
                                                                [theme]="{ width: '170px', 'border-radius': '0', height: '5px' }">
                                                            </ngx-skeleton-loader>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </li>
                                    </ng-container>
                                    <ng-template #commentsConetent>
                                        <ng-container *ngIf="postComments?.length;else noCommentsYet">
                                            <li *ngFor="let comment of postComments;let commentIndex = index"
                                                class="d-flex">
                                                <img [routerLink]="['/visit',comment?.user?._id]"
                                                    style="cursor: pointer;"
                                                    [src]="comment?.user?.profilePhoto | gender : comment.user?.gender "
                                                    alt="">
                                                <ng-container
                                                    *ngIf="editCommentIndex == commentIndex;else commentContent">
                                                    <div class="w-100">
                                                        <div style="padding-right: 15px;"
                                                            class="position-relative">

                                                            <textarea class="ml-2"
                                                                style="margin-right: 0;height:32px !important"
                                                                #editCommentInpu
                                                                (input)="textAreaHeightAuto(editCommentInpu)"
                                                                (focus)="enterESCtoCancel=true"
                                                                (blur)="enterESCtoCancel=false"
                                                                (keydown.esc)="editCommentIndex=-1"
                                                                (keydown.enter)="updateComment(comment?._id,editCommentInpu.value,comment?.post,i,$event)"
                                                                placeholder="Write a comment...">{{comment?.comment | lang : editCommentInpu}}</textarea>
                                                            <i style="right: 20px;"
                                                                (click)="updateComment(comment?._id,editCommentInpu.value,comment?.post,i,$event)"
                                                                class="fas fa-paper-plane text-primary d-md-none"></i>
                                                        </div>
                                                        <small class="mx-2 "><span class="d-none d-md-inline"
                                                                *ngIf="enterESCtoCancel">Press Esc To </span>
                                                            <span class="text-primary" style="cursor: pointer;"
                                                                (click)="editCommentIndex=-1">cancel</span>.</small>
                                                    </div>
                                                </ng-container>
                                                <ng-template #commentContent>
                                                    <div class="mx-2">
                                                        <div class="commnetContent">
                                                            <div class="d-flex">
                                                                <p [routerLink]="['/visit',comment?.user?._id]"
                                                                    style="cursor: pointer;"
                                                                    class="font-weight-bold">
                                                                    {{comment.user?.firstName | titlecase |
                                                                    slice : 0 : 12}}
                                                                    {{comment.user?.lastName | titlecase | slice
                                                                    : 0 : 12}}
                                                                </p>
                                                                <i [matMenuTriggerFor]="EditComment"
                                                                    *ngIf="comment?.user?._id == userProfilesService.userProfile?._id"
                                                                    class=" fas fa-ellipsis-h mx-2"
                                                                    style="cursor: pointer;"></i>
                                                                <mat-menu #EditComment="matMenu">
                                                                    <div
                                                                        [class.darkModeMenu]="userProfilesService.userProfile?.darkMode">
                                                                        <button mat-menu-item
                                                                            (click)="editCommentIndex = commentIndex;resizeTextArea()">
                                                                            Edit
                                                                        </button>
                                                                        <button
                                                                            (click)="deleteComment(comment?._id,comment?.post,i)"
                                                                            mat-menu-item>
                                                                            Delete
                                                                        </button>
                                                                    </div>
                                                                </mat-menu>
                                                            </div>
                                                            <p #commentP>{{comment?.comment | lang : commentP}}
                                                            </p>
                                                        </div>
                                                        <div class="position-relative">
                                                            <div class="timee d-inline-block">
                                                                <small
                                                                    class="text-secondary ">{{comment?.createdAt
                                                                    | date :'medium'
                                                                }}</small>
                                                                <small class="timeOnHover">{{comment?.createdAt
                                                                    | date :'medium'}}</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </ng-template>
                                            </li>
                                        </ng-container>
                                        <ng-template #noCommentsYet>
                                            <li>No Comments Yet</li>
                                        </ng-template>
                                    </ng-template>
                                </ul>
                            </div>
                        </ng-container>
                    </div>
               
                </div>
            </ng-container>
         <!-- start modal when no posts found -->
        <ng-template #noPosts>
            <div class="text-center bg-white p-3 my-3 rounded-lg noMorePosts">
                <h2 class="font-weight-bold text-secondary">
                    No More Posts
                </h2>
                <h3 class="my-2">Add more friends to see more posts in your News Feed.</h3>
                <button class="btn btn-primary"  routerLink="/peopleYouMayKnow">Find Friends</button>
            </div>
        </ng-template>
          <!-- end modal when no posts found -->
        </ng-template>
         <!-- end posts conetent -->
    </div>
</div>

<ng-template #reaction>
    <div class="parentOfReactionsModal" [class.popupDarkMode]="userProfilesService.userProfile?.darkMode">
        <div class="modal-header">
            
<swiper  [config]="reactionSwiper">
 
    <ng-template swiperSlide>
        <div style="cursor: pointer;text-align:center;" class="p-2"
         [class.like]="filterReactions==''"
        (click)="filterReactions='';reacionsModaClassIndex=-1">All</div>
    </ng-template>
    <ng-container *ngFor="let item of sortReaction;let i = index">
        <ng-template swiperSlide>
                <div 
                style="cursor: pointer;text-align: center;"
                (click)="filterReactions=item?.reactionImg;reacionsModaClassIndex=i"
                    [ngClass]="reacionsModaClassIndex==i ?  item?.reactionImg :  ''"
                    class="d-flex align-items-center p-2" >
                    <img style="width: 20px;height: 20px;margin: 0 5px;" [src]="'assets/'+item?.reactionImg+'.png'"
                        alt="">
                    <p>{{item?.length}}</p>
                </div>
        </ng-template>
    </ng-container>

</swiper>
            <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <div class="modal-body parentOfimg reactionsModal">
            <ul class="list-unstyled">
                <li class="mb-3" *ngFor="let item of postReactions | reactionType : filterReactions">
                    <div class="d-flex align-items-center">
                        <div class="position-relative">
                            <img style="cursor: pointer;" (click)="modalRef.hide()"
                                [routerLink]="['/visit',item?.user?._id]" class="mainIMG"
                                [src]="item?.user?.profilePhoto | gender : item?.user?.gender" alt="">
                            <img [src]="'assets/'+item?.reaction+'.png'" class="reactionImg" alt="">
                        </div>
                        <h3 (click)="modalRef.hide()" style="cursor: pointer;" [routerLink]="['/visit',item?.user?._id]"
                            class="mx-3">
                            {{item?.user?.firstName | titlecase | slice : 0 : 12}}
                            {{item?.user?.lastName | titlecase | slice : 0 : 12}}
                        </h3>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</ng-template>
<div  
*ngIf="userProfileService.popUP"
class="popupp">
    <div class="imgSection">

        <img *ngIf="popupPost?.image;else popupLoading" [src]="popupPost?.image" alt="">
        <ng-template #popupLoading>
            <div class="lds-ring">
                <div></div>
                <div></div>
                <div></div>
                <div></div>
            </div>
        </ng-template>

        <p (click)="showCommentsInMobileScreen(commentsSection)" class="showComments">
            <i class="far fa-comment-alt"></i> <span class="mx-2">Show Comments</span>
        </p>
        <i (click)="closePopup()" class="fas fa-times"></i>
    </div>
    <div #commentsSection class="zIndex commentsSection p-3">
        <div class="d-flex align-items-center pt-3 ">
            <img class="profilePopup"
                [src]="popupPost?.author?.profilePhoto  | gender : popupPost?.author?.gender "
                alt="">
            <div class="mx-2">
                 <h2 class="m-0">
                   {{popupPost?.author?.firstName | titlecase | slice : 0 : 12}}
                    {{popupPost?.author?.lastName | titlecase | slice : 0 : 12}}
                </h2>
                <small class="text-secondary">
                    {{popupPost?.updatedAt | date : 'medium'}}
                </small>
            </div>
            <i (click)="hideCommentsInMobileScreen(commentsSection)"
                class="fas fa-times"></i>
        </div>
         <div class="autoScroll parentOfComments">
            <p class="py-3 mx-2">{{popupPost?.content}}</p>
            
            <div  class="postOptions">
                <div *ngIf="!commentsLoading" class="m-2 d-flex justify-content-between align-items-center">
                    <div 
                     class="position-relative   reactionsCount ">                                             
                                <img class="first" 
                                #firstIMG
                                [src]="popupReactions?.numOfLoves | mostReaction : popupReactions?.numOfSads : popupReactions?.numOfWows : popupReactions?.numOfHahas : popupReactions?.numOfAngrys : popupReactions?.numOfLikes : firstIMG" alt="">
                                <img #secondIMG  class="last" 
                                [src]="popupReactions?.numOfLoves | secondReaction: popupReactions?.numOfSads : popupReactions?.numOfWows :popupReactions?.numOfHahas : popupReactions?.numOfAngrys : popupReactions?.numOfLikes  : secondIMG" alt=""> 
                                <span  
                                *ngIf="popupReactions?.numOfReactions">
                                {{popupReactions?.numOfReactions}}</span>   
                                                  
                </div>   
                <p   *ngIf="postComments?.length">
                    {{postComments?.length}}
                    {{postComments?.length==1 ? "Comment" : "Comments"}}
                </p>
            </div>
                <div class="parentOfComments mt-2">
                    <ul class="comments list-unstyled my-2">
                          <ng-container *ngIf="commentsLoading;else commentsConetent">
                            <li *ngFor="let item of swiperLoadingCount">
                                <div [class.darkMode]="userProfilesService.userProfile?.darkMode"
                                    class="fb-item bg-white postsLoadingg rounded-lg">
                                    <div
                                        class="first-section-wrapper d-flex align-items-center mb-3">
                                        <div class="gravatar ">
                                            <ngx-skeleton-loader appearance="circle"
                                                [theme]="{
                                            'width': '32px',
                                            'height': '32px',
                                            'margin':'0'
                                        }">
                                            </ngx-skeleton-loader>
                                        </div>
                                        <div class="gravatar-title mx-3">
                                            <div>
                                                <ngx-skeleton-loader [theme]="{
                                  width: '200px',
                                  'border-radius': '0',
                                  height: '5px',
                                  'margin-bottom': '5px'
                                }"></ngx-skeleton-loader>
                                            </div>
                                            <div>
                                                <ngx-skeleton-loader
                                                    [theme]="{ width: '170px', 'border-radius': '0', height: '5px' }">
                                                </ngx-skeleton-loader>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ng-container>  
                         <ng-template #commentsConetent>
                            <ng-container *ngIf="postComments?.length;else noCommentsYet">
                                <li *ngFor="let comment of postComments;let commentIndex = index"
                                    class="d-flex">
                                    <img [routerLink]="['/visit',comment?.user?._id]"
                                        style="cursor: pointer;"
                                        [src]="comment?.user?.profilePhoto | gender :  comment.user?.gender"
                                        alt="">
                                    <div class="mx-2">
                                        <div class="commnetContent">
                                            <p [routerLink]="['/visit',comment?.user?._id]"
                                                style="cursor: pointer;"
                                                class="font-weight-bold">
                                                {{comment.user?.firstName | titlecase |
                                                slice : 0 : 12}}
                                                {{comment.user?.lastName | titlecase | slice
                                                : 0 : 12}}
                                            </p>
                                            <p #commentP>{{comment?.comment | lang :
                                                commentP}}</p>
                                        </div>
                                        <div class="position-relative">
                                            <div class="timee d-inline-block">
                                                <small
                                                    class="text-secondary ">{{comment?.createdAt
                                                    | date :'medium'}}</small>
                                                <small
                                                    class="timeOnHover">{{comment?.createdAt
                                                    | date :'medium'}}</small>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ng-container>
                            <ng-template #noCommentsYet>
                                <li>No Comments Yet</li>
                            </ng-template>
                        </ng-template> 
                    </ul>
                </div>
            </div>
        </div> 
    </div>
</div>